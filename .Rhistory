</div>
# Statistiques descriptives
<div id="left">
Pour ajuster la position (en x) des moyennes en fonction de sex on peut procéder comme suit:
```{r, fig.width=6, fig.height=4, fig.path="figures/",label="position", fig.show="hide"}
p <- ggplot(catdata,aes(x=haircolor,y=weight)) +
geom_boxplot(aes(fill=sex)) +
stat_summary(fun.y=mean,
geom="point",
aes(fill=sex),
position=position_dodge(width=0.75))
plot(p)
```
</div>
<div id="right">
![](figures/position-1.png)
</div>
# Modèle de régression
<div id="left">
Le package `ggplot2` offre aussi des possibilités intéressantes pour travailler sur le lien entre deux variables quantitatives (modèles de régression):
```{r,  fig.width=6, fig.height=4}
p <- ggplot(catdata, aes(x=age,y=weight)) +
geom_point(aes(col=sex)) +
geom_smooth()
plot(p)
```
</div>
<div id="right">
On ajoute une droite de régression avec la fonction `geom_smooth` (ici par défaut, régression de type loess). Allez voir le fichier d'aide associé à la fonction `geom_smooth` pour voir l'ensemble des paramètres de cette fonction...
Plus d'explications sur la régression loess [ici](http://perso.ens-lyon.fr/lise.vaudor/regression-loess/)
</div>
# Modèle de régression
On peut préciser le modèle en précisant des aesthetics supplémentaires:
```{r,  fig.width=6, fig.height=4}
p <- ggplot(catdata, aes(x=age,y=weight,col=sex)) +
geom_point() +
geom_smooth()
plot(p)
```
# Modèle de régression linéaire
<div id="left">
Le type de régression réalisé est également paramétrable. Ici, par exemple, on réalise une régression linéaire:
```{r,  fig.width=6, fig.height=4}
p <- ggplot(catdata, aes(x=age,y=weight)) +
geom_point(aes(col=sex))+
geom_smooth(mapping=aes(col=sex),
method="lm")
plot(p)
```
</div>
<div id="right">
`ggplot2` permet de produire la **représentation graphique** du modèle de régression. Pour effectuer une régression et (par exemple récupérer ses coefficients), on passe par `lm()`:
```{r}
reg=lm(weight~age*sex, data=catdata)
summary(reg)
```
</div>
require(ggplot2)
catdata <- read.csv("../../datasets/catdata.csv", sep=";")
p <- ggplot(catdata,aes(x=haircolor,y=weight)) +
geom_boxplot(aes(fill=sex)) +
stat_summary(fun.y=mean,
geom="point")
plot(p)
p <- ggplot(catdata,aes(x=haircolor,y=weight)) +
geom_boxplot(aes(fill=sex)) +
stat_summary(fun.y=mean,
geom="point",
aes(fill=sex))
plot(p)
p <- ggplot(catdata,aes(x=haircolor,y=weight)) +
geom_boxplot(aes(fill=sex)) +
stat_summary(fun.y=mean,
geom="point")
plot(p)
p <- ggplot(catdata,aes(x=haircolor,y=weight,fill=sex)) +
geom_boxplot() +
stat_summary(fun.y=mean,
geom="point")
plot(p)
p <- ggplot(catdata,aes(x=haircolor,y=weight)) +
geom_boxplot(aes(fill=sex)) +
stat_summary(fun.y=mean,
geom="point",
aes(fill=sex),
position=position_dodge(width=0.75))
plot(p)
p <- ggplot(catdata, aes(x=age,y=weight)) +
geom_point(aes(col=sex)) +
geom_smooth()
plot(p)
p <- ggplot(catdata, aes(x=age,y=weight,col=sex)) +
geom_point() +
geom_smooth()
plot(p)
p <- ggplot(catdata, aes(x=age,y=weight)) +
geom_point(aes(col=sex))+
geom_smooth(mapping=aes(col=sex),
method="lm")
plot(p)
reg=lm(weight~age*sex, data=catdata)
summary(reg)
p <- ggplot(diamonds, aes(x=cut, y=price)) +
geom_boxplot(fill="pink")+
stat_summary(fun="mean", geom="point",color="red")
plot(p)
p <- ggplot(diamonds, aes(x=cut, y=price)) +
geom_boxplot(fill="pink")+
stat_summary(fun="mean", geom="point",color="blue")
plot(p)
p <- ggplot(diamonds, aes(x=cut, y=price)) +
geom_boxplot(fill="pink")+
stat_summary(fun="mean",color="blue")
plot(p)
p <- ggplot(diamonds, aes(x=carat, y= price))+
geom_point()+
stat_summary(fun.x="mean", geom="line", aes(color=cut))
plot(p)
p <- ggplot(diamonds, aes(x=carat, y= price))+
geom_point()+
stat_summary(fun.y="mean", geom="line", aes(color=cut))
plot(p)
p <- ggplot(diamonds, aes(x=cut, y= price))+
geom_point()+
stat_summary(fun.x="mean", geom="line", aes(color=cut))
p <- ggplot(diamonds, aes(x=cut, y= price))+
geom_violin()+
stat_summary(fun.x="mean", geom="line", aes(color=cut))
plot(p)
p <- ggplot(diamonds, aes(x=cut, y= price))+
geom_violin()+
stat_summary(fun.y="mean", geom="line", aes(color=cut))
plot(p)
p <- ggplot(diamonds, aes(x=cut, y= price))+
geom_violin()+
stat_summary(fun.y="mean", geom="point", aes(color=cut))
plot(p)
p <- ggplot(diamonds, aes(x=cut, y= price))+
geom_violin()+
stat_summary(fun.y="mean", geom="point", aes(color=clarity))
plot(p)
help(diamonds)
p <- ggplot(diamonds, aes(x=cut, y= price))+
geom_violin(aes(color=cut))+
stat_summary(fun.y="mean", geom="point")
plot(p)
p <- ggplot(diamonds, aes(x= price))+
geom_violin(aes(color=cut))+
stat_summary(fun.y="mean", geom="point")
plot(p)
p <- ggplot(diamonds, aes(x= price))+
geom_histogram(aes(color=cut))+
stat_summary(fun.y="mean", geom="point")
plot(p)
p <- ggplot(diamonds, aes(x= price))+
geom_histogram(aes(color=cut))+
stat_summary(fun.y="mean", geom="point")
p <- ggplot(diamonds, aes(x= price))+
geom_histogram(aes(color=cut))+
stat_summary(fun.x="mean", geom="point")
plot(p)
p <- ggplot(diamonds, aes(x= price))+
geom_histogram(aes(color=cut))+
stat_summary(fun.x="mean", geom="point")
p <- ggplot(diamonds, aes(x= price))+
geom_histogram(aes(color=cut))+
stat_summary(fun="mean", geom="point")
p <- ggplot(diamonds, aes(x= price))+
geom_histogram(aes(color=cut))
plot(p)
p <- ggplot(diamonds, aes(x= price))+
geom_histogram(aes(fill=cut))
plot(p)
p <- ggplot(diamonds, aes(x= price))+
geom_histogram(aes(fill=cut))+
stat_summary(fun="mean", geom="point")
plot(p)
p <- ggplot(diamonds, aes(x= price))+
geom_histogram(aes(fill=cut))+
stat_summary(fun.x="mean", geom="line")
plot(p)
p <- ggplot(diamonds, aes(x=cut, y=price)) +
geom_boxplot()+
stat_summary(fun="mean", geom="point",color="blue")
plot(p)
p <- ggplot(diamonds, aes(x=cut, y=price, fill=cut) +
geom_boxplot(linetype=clarity)+
stat_summary(fun="mean", geom="point",color="blue")
plot(p)
p <- ggplot(diamonds, aes(x=cut, y=price, fill=cut)) +
geom_boxplot(linetype=clarity)+
stat_summary(fun="mean", geom="point",color="blue")
p <- ggplot(diamonds, aes(x=cut, y=price, fill=cut)) +
geom_boxplot(aes(linetype=clarity))+
stat_summary(fun="mean", geom="point",color="blue")
plot(p)
p <- ggplot(diamonds, aes(x=cut, y=price, fill=clarity)) +
geom_boxplot(aes(position=cut))+
stat_summary(fun="mean", geom="point",color="blue")
p <- ggplot(diamonds, aes(x=cut, y=price, fill=clarity)) +
geom_boxplot(aes(color=cut))+
stat_summary(fun="mean", geom="point",color="blue")
plot(p)
p <- ggplot(diamonds, aes(x=cut, y=price, fill=clarity)) +
geom_boxplot(aes(color=cut))+
stat_summary(fun="mean", geom="point",color="blue", aes(position=position_dodge(0.75)))
plot(p)
p <- ggplot(diamonds, aes(x=cut, y=price, fill=clarity)) +
geom_boxplot(aes(color=cut))+
stat_summary(fun="mean", geom="point",color="blue", position=position_dodge(0.75))
plot(p)
p <- ggplot(diamonds, aes(x=cut, y=price, fill=cut)) +
geom_boxplot()+
stat_summary(fun="max", geom="line",color="blue", position=position_dodge(0.75))
plot(p)
p <- ggplot(diamonds, aes(x=cut, y=price, fill=cut)) +
geom_boxplot()+
stat_summary(fun="mean", geom="line",color="blue", position=position_dodge(0.75))
plot(p)
p <- ggplot(diamonds, aes(x=cut, y=price, fill=cut)) +
geom_boxplot()+
stat_summary(fun.y="mean", geom="line",color="blue", position=position_dodge(0.75))
plot(p)
p <- ggplot(diamonds, aes(x=cut, y=price, fill=cut)) +
geom_boxplot()+
stat_summary(fun.y="mean", geom="line",color="blue")
plot(p)
p <- ggplot(diamonds, aes(x=carat, y=price, fill=cut)) +
geom_smooth()
plot(p)
p <- ggplot(diamonds, aes(x=carat, y=price, color=price)) +
geom_point(aes(fill="cut"))+
geom_smooth()
plot(p)
p <- ggplot(diamonds, aes(x=carat, y=price, fill=cut)) +
geom_point()+
geom_smooth()
plot(p)
p <- ggplot(diamonds, aes(x=carat, y=price, color=cut, fill=cut)) +
geom_point()+
geom_smooth()
plot(p)
p <- ggplot(diamonds, aes(x=carat, y=price, color=cut,shape=clarity)) +
geom_point()+
geom_smooth()
plot(p)
p <- ggplot(diamonds, aes(x=carat, y=price, color=cut)) +
geom_point(aes(shape=clarity))+
geom_smooth()
plot(p)
p <- ggplot(diamonds, aes(x=carat, y=price, color=cut)) +
geom_point(aes(shape=clarity))+
geom_smooth()
plot(p)
p <- ggplot(diamonds, aes(x=carat, y=price)) +
geom_point(aes(shape=clarity))+
geom_smooth()
plot(p)
p <- ggplot(diamonds, aes(x=carat, y=price)) +
geom_point(aes(alpha=-table))+
geom_smooth()
plot(p)
p <- ggplot(diamonds, aes(x=carat, y=price)) +
geom_point(aes(size=table))+
geom_smooth()
plot(p)
p <- ggplot(diamonds, aes(x=carat, y=price)) +
geom_point(aes(size=table), alpha=0.9)+
geom_smooth()
plot(p)
p <- ggplot(diamonds, aes(x=carat, y=price)) +
geom_point(aes(size=table), alpha=0.9)+
geom_smooth()
plot(p)
p <- ggplot(diamonds, aes(x=carat, y=price)) +
geom_point(aes(size=table), alpha=0.2)+
geom_smooth()
plot(p)
p <- ggplot(diamonds, aes(x=carat, y=price, color=cut)) +
geom_point(aes(size=table), alpha=0.2)+
geom_smooth()
plot(p)
p <- ggplot(diamonds, aes(x=carat, y=price, color=cut)) +
geom_point(aes(size=table), alpha=0.1)+
geom_smooth()
plot(p)
p <- ggplot(diamonds, aes(x=carat, y=price, color=cut)) +
geom_point(aes(size=center(table)), alpha=0.1)+
geom_smooth()
plot(p)
help(scale_size_area)
p <- ggplot(diamonds, aes(x=carat, y=price, color=cut)) +
geom_point(aes(size=table), alpha=0.1)+
scale_size_area(trans="log")
geom_smooth()
p <- ggplot(diamonds, aes(x=carat, y=price, color=cut)) +
geom_point(aes(size=table), alpha=0.1)+
scale_size_area(trans="log")+
geom_smooth()
plot(p)
hist(diamonds$table)
p <- ggplot(diamonds, aes(x=carat, y=price, color=cut)) +
geom_point(aes(size=table), alpha=0.1)+
scale_size_area(range=c(0,5))+
geom_smooth()
p <- ggplot(diamonds, aes(x=carat, y=price, color=cut)) +
geom_point(aes(size=table), alpha=0.1)+
scale_size_area(limits=c(50,90))+
geom_smooth()
plot(p)
p <- ggplot(diamonds, aes(x=carat, y=price, color=cut)) +
geom_point(aes(size=table), alpha=0.1)+
scale_size_area(limits=c(50,90),range=c(1,4))+
geom_smooth()
p <- ggplot(diamonds, aes(x=carat, y=price, color=cut)) +
geom_point(aes(size=table-min(table)), alpha=0.1)+
scale_size_area(limits=c(50,90),range=c(1,4))+
geom_smooth()
p <- ggplot(diamonds, aes(x=carat, y=price, color=cut)) +
geom_point(aes(size=table-min(table)), alpha=0.1)+
scale_size_area()+
geom_smooth()
plot(p)
p <- ggplot(diamonds, aes(x=carat, y=price, color=cut)) +
geom_point(aes(size=log(table-min(table)), alpha=0.1)+
scale_size_area()+
geom_smooth()
plot(p)
p <- ggplot(diamonds, aes(x=carat, y=price, color=cut)) +
geom_point(aes(size=log(table-min(table))), alpha=0.1)+
scale_size_area()+
geom_smooth()
plot(p)
p <- ggplot(diamonds, aes(x=carat, y=price, color=cut)) +
geom_point(aes(size=table, alpha=0.1)+
scale_size_area()+
geom_smooth()
plot(p)
p <- ggplot(diamonds, aes(x=carat, y=price, color=cut)) +
geom_point(aes(size=table), alpha=0.1)+
scale_size_area()+
geom_smooth()
plot(p)
p <- ggplot(diamonds, aes(x=carat, y=price, color=cut)) +
geom_point(aes(size=table), alpha=0.1)+
scale_size_area()+
geom_smooth(method="lm")
plot(p)
p <- ggplot(diamonds, aes(x=carat, y=price, color=cut)) +
geom_point(aes(size=table), alpha=0.1)+
geom_smooth(method="lm", aes(fill=clarity))
plot(p)
p <- ggplot(diamonds, aes(x=carat, y=price, color=cut)) +
geom_smooth(method="lm", aes(fill=clarity))
plot(p)
p <- ggplot(diamonds, aes(x=carat, y=price, color=cut)) +
geom_point(aes(size=table), alpha=0.1)+
geom_smooth(method="lm", aes(linetype=clarity))
plot(p)
p <- ggplot(diamonds, aes(x=carat, y=price)) +
geom_point(aes(color=cut), alpha=0.1)+
geom_smooth(method="lm", aes(linetype=clarity))
plot(p)
p <- ggplot(diamonds, aes(x=carat, y=price)) +
geom_point(aes(color=cut))+
geom_smooth()+
facet_grid(.~cut)
plot(p)
p <- ggplot(diamonds, aes(x=carat, y=price,color=cut)) +
geom_point(aes())+
geom_smooth()+
facet_grid(.~cut)
plot(p)
p <- ggplot(diamonds, aes(x=carat, y=price) +
geom_point()+
geom_smooth(aes(color=cut, fill=clarity))+
facet_grid(clarity~cut)
plot(p)
p <- ggplot(diamonds, aes(x=carat, y=price) +
geom_point()+
geom_smooth(aes(color=cut, fill=clarity))+
facet_grid(clarity ~ cut)
plot(p)
p <- ggplot(diamonds, aes(x=carat, y=price) +
geom_point()+
geom_smooth(aes(color=cut, fill=clarity))
p <- ggplot(diamonds, aes(x=carat, y=price) +
p <- ggplot(diamonds, aes(x=carat, y=price) +
geom_point() +
geom_smooth(aes(color=cut, fill=clarity))
p <- ggplot(diamonds, aes(x=carat, y=price)) +
p <- ggplot(diamonds, aes(x=carat, y=price)) +
geom_point()
p <- ggplot(diamonds, aes(x=carat, y=price)) +
geom_point() +
geom_smooth(aes(color=cut, fill=clarity))
p <- ggplot(diamonds, aes(x=carat, y=price)) +
geom_point() +
geom_smooth(aes(color=cut, fill=clarity)) +
facet_grid(. ~ cut)
plot(p)
p <- ggplot(diamonds, aes(x=carat, y=price)) +
geom_point() +
geom_smooth(aes(color=cut)) +
facet_grid(cut ~ .)
plot(p)
p <- ggplot(diamonds, aes(x=carat, y=price)) +
geom_point(color="grey") +
geom_smooth(aes(color=cut)) +
facet_grid(cut ~ .)
plot(p)
help(geom_smooth)
p <- ggplot(diamonds, aes(x=carat, y=price)) +
geom_point(color="grey") +
geom_smooth(aes(color=cut)) +
geom_smooth()
facet_grid(cut ~ .)
plot(p)
p <- ggplot(diamonds, aes(x=carat, y=price)) +
geom_point(color="grey") +
geom_smooth(aes(color=cut)) +
geom_smooth()+
facet_grid(cut ~ .)
plot(p)
p <- ggplot(diamonds, aes(x=carat, y=price)) +
geom_point(color="grey") +
geom_smooth()+
geom_smooth(aes(color=cut)) +
facet_grid(cut ~ .)
plot(p)
p <- ggplot(diamonds, aes(x=carat, y=price)) +
geom_point(color="grey") +
geom_smooth(color="blue")+
geom_smooth(aes(color=cut)) +
facet_grid(cut ~ .)
plot(p)
p <- ggplot(diamonds, aes(x=carat, y=price)) +
geom_point(color="grey") +
geom_smooth(color="blue", method="lm")+
geom_smooth(aes(color=cut)) +
facet_grid(cut ~ .)
plot(p)
p <- ggplot(diamonds, aes(x=carat, y=price)) +
geom_point(color="grey") +
geom_smooth(color="blue", method="lm")+
geom_smooth(aes(color=cut), method="lm") +
facet_grid(cut ~ .)
plot(p)
p <- ggplot(diamonds, aes(x=carat, y=price)) +
geom_point(color="grey") +
geom_smooth(color="blue")+
geom_smooth(aes(color=cut)) +
facet_grid(cut ~ .)
plot(p)
p <- ggplot(diamonds, aes(x=carat, y=price)) +
geom_point(color="grey") +
geom_smooth(color="blue")+
geom_smooth(aes(color=cut)) +
facet_grid(cut ~ .)
plot(p)
p <- ggplot(diamonds, aes(x=carat, y=price)) +
geom_point(color="grey", aes(shape=clarity)) +
geom_smooth(aes(color=cut)) +
facet_grid(cut ~ .)
plot(p)
p <- ggplot(diamonds, aes(x=carat, y=price)) +
geom_point(color="grey", aes(shape=clarity)) +
geom_smooth() +
facet_grid(cut ~ .)
plot(p)
data("economics")
help("economics")
economics_long
economics
plot(economics$date,economics$pop)
plot(economics$date,economics$pop,)
txhousing
p <- ggplot(txhousing, aes(x=date, y=volume))+
geom_line(aes(color=city))+
geom_smooth()
p <- ggplot(txhousing, aes(x=date, y=volume))+
geom_line(aes(color=city))+
geom_smooth()
plot(p)
p <- ggplot(txhousing, aes(x=date, y=volume))+
geom_line(aes(color=city))+
geom_smooth()
plot(p)
p <- ggplot(txhousing, aes(x=date, y=volume))+
geom_line(aes(color=city))+
geom_smooth()+
facet_wrap(~city)
plot(p)
p <- ggplot(txhousing, aes(x=date, y=volume))+
geom_line(aes(color=city), show.legend=FALSE)+
geom_smooth()+
facet_wrap(~city)
plot(p)
help(facet_wrap)
p <- ggplot(txhousing, aes(x=date, y=volume))+
geom_line(aes(color=city), show.legend=FALSE)+
geom_smooth()+
facet_wrap(~city, scales="free")
plot(p)
p <- ggplot(txhousing, aes(x=date, y=volume))+
geom_line()+
geom_smooth()+
facet_wrap(~city, scales="free")
plot(p)
txhousing$year
range(txhousing$year)
help(facet_wrap)
